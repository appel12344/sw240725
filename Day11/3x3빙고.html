<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>리무쿠라의 3X3 빙고게임</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        h1 {
            margin-bottom: 500px;
        }
        .btn {
            cursor: pointer;
            border: none;
            border-radius: 5px;
            color: rgb(0, 0, 0);
            font-weight: bold;
        }
    </style>
    <script>
        // 지정된 CSS 값을 사용하여 새로운 박스를 만드는 함수
        function MakeBox(cssValue) {
            this.div = document.createElement('div');
            this.div.style.position = "absolute";
            this.div.style.border = "1px solid black";
            this.div.style.left = cssValue.left;
            this.div.style.top = cssValue.top;
            this.div.style.width = cssValue.width;
            this.div.style.height = cssValue.height;
            document.body.appendChild(this.div);
            if (window.boxArr == null) {
                window.boxArr = [];
            }
            boxArr.push(this.div);
        };

        // 지정된 값을 사용하여 새로운 버튼을 만드는 함수
        function MakeBtn(values) {
            this.btn = document.createElement('button');
            this.btn.className = 'btn';
            document.body.appendChild(this.btn);
            this.btn.innerHTML = values.text;
            this.btn.style.position = 'absolute';
            this.btn.style.backgroundColor = values.color;
            this.btn.style.left = values.left;
            this.btn.style.top = values.top;
            this.btn.style.width = values.width;
            this.btn.style.height = values.height;
            this.btn.style.fontSize = values.fontSize;

            var thisTarget = null;
            window.zIndex = 1;

            function boxPoint(x1, y1, x2, y2) {
                this.x1 = x1;
                this.y1 = y1;
                this.x2 = x2;
                this.y2 = y2;
            }

            this.btn.onmousedown = function(evt) {
                evt.preventDefault();
                var boxPointArr = [];
                for (var i = 0; i < boxArr.length; i++) {
                    var x1 = boxArr[i].offsetLeft;
                    var y1 = boxArr[i].offsetTop;
                    var x2 = x1 + boxArr[i].offsetWidth;
                    var y2 = y1 + boxArr[i].offsetHeight;
                    boxPointArr.push(new boxPoint(x1, y1, x2, y2));
                }

                thisTarget = this;
                thisTarget.x = thisTarget.offsetLeft;
                thisTarget.y = thisTarget.offsetTop;
                this.style.zIndex = window.zIndex;
                window.zIndex += 1;
                thisTarget.xGap = evt.clientX - thisTarget.offsetLeft;
                thisTarget.yGap = evt.clientY - thisTarget.offsetTop;

                document.onmousemove = function(moveEvent) {
                    thisTarget.style.left = moveEvent.clientX - thisTarget.xGap + "px";
                    thisTarget.style.top = moveEvent.clientY - thisTarget.yGap + "px";
                };

                document.onmouseup = function() {
                    var x1 = thisTarget.offsetLeft + thisTarget.offsetWidth / 2;
                    var y1 = thisTarget.offsetTop + thisTarget.offsetHeight / 2;
                    var idx = -1;
                    for (var i = 0; i < boxPointArr.length; i++) {
                        var p = boxPointArr[i];
                        var b1 = (x1 >= p.x1 && x1 <= p.x2) && (y1 >= p.y1 && y1 <= p.y2);
                        if (b1) {
                            idx = i;
                        }
                    }
                    if (idx != -1) {
                        thisTarget.style.left = boxPointArr[idx].x1 + 1 + "px";
                        thisTarget.style.top = boxPointArr[idx].y1 + 1 + "px";
                    }
                    document.onmousemove = null;
                };
            };
        };

        window.onload = function() {
            // 새로운 버튼 생성
            new MakeBtn({
                'text': 'X',
                'color': 'yellow',
                'left': '200px',
                'top': '50px',
                'width': '100px',
                'height': '100px',
                'fontSize': '40px'
            });

            new MakeBtn({
                'text': 'O',
                'color': 'green',
                'left': '320px',
                'top': '50px',
                'width': '100px',
                'height': '100px',
                'fontSize': '40px'
            });

            const boxSize = 100;
            const boxMargin = 10;
            const totalGridSize = 3 * boxSize + 2 * boxMargin; // 3x3 그리드의 전체 너비와 높이
            const centerX = (window.innerWidth - totalGridSize) / 2;
            const centerY = (window.innerHeight - totalGridSize) / 2;

            for (let row = 0; row < 3; row++) {
                for (let col = 0; col < 3; col++) {
                    new MakeBox({
                        'left': `${centerX + col * (boxSize + boxMargin)}px`,
                        'top': `${centerY + row * (boxSize + boxMargin)}px`,
                        'width': `${boxSize}px`,
                        'height': `${boxSize}px`
                    });
                }
            }
        };
    </script>
</head>
<body>
    <h1>리무쿠라 현효의 3x3 빙고게임</h1>
</body>
</html>
